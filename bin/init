#!/bin/sh

set -e

# check & gen ssl certificate
if [ ! -e "${SSL_CERTFILE}" ] || [ ! -e "${SSL_KEYFILE}" ]; then
  openssl req -newkey rsa:2048 -sha256 -nodes -x509 -days 365 -subj "/O=ElectrumX" -keyout "${SSL_KEYFILE}" -out "${SSL_CERTFILE}"
fi

# optional local init script
if [ -e /data/init.sh ]; then
    source /data/init.sh
fi

# run electrumx server
exec /electrumx/electrumx_server
